<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Symmetry analysis of phonon interactions &mdash; Principia Materia  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Finite Displacements" href="finite_displacements.html" />
    <link rel="prev" title="Hamiltonian" href="../hamiltonian/hamiltonian.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../contents.html" class="icon icon-home"> Principia Materia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../documentation/contents.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../documentation/crystal_structure.html">Entering Crystal Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/compute_id.html">Compute Irreducible Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/compute_thermal.html">Compute Phonon Linewidth and Thermal Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translation_group/translation_group.html">Translation Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../representation/group_theory_demostrations.html">Symmetry of a molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../representation/group_theory_demostrations.html#Symmetry-analysis-for-phonons">Symmetry analysis for phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hamiltonian/hamiltonian.html">Hamiltonian</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Symmetry analysis of phonon interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Analytic-dynamic-tensor">Analytic dynamic tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Little-group-ADT">Little group ADT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Analytic-tensors-within-a-given-FTG-at-a-given-order">Analytic tensors within a given FTG at a given order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Chainrule-derivatives">Chainrule derivatives</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finite_displacements.html">Finite Displacements</a></li>
<li class="toctree-l2"><a class="reference internal" href="lid.html">Lone Irreducible Derivatives (LID) Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="bid.html">Bundled Irreducible Derivatives (BID) Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="bid.html#Hierarchical-Supercell-BID-Approach">Hierarchical Supercell BID Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="linewidth.html">Phonon linewidth and thermal conductivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/contents.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/modules.html">API Documentations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Principia Materia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../documentation/contents.html">Documentation</a> &raquo;</li>
      <li>Symmetry analysis of phonon interactions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/phonon_id/phonon_interaction_analysis.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Symmetry-analysis-of-phonon-interactions">
<h1>Symmetry analysis of phonon interactions<a class="headerlink" href="#Symmetry-analysis-of-phonon-interactions" title="Permalink to this headline"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import numpy as np
np.set_printoptions(linewidth=180, suppress=True)
from principia_materia import Fraction
from principia_materia.io_interface import parse_array
from principia_materia.translation_group import CrystalFTG
from principia_materia.io_interface.qpoints_io import tuple_to_str
from principia_materia.phonon_id.little_group_adt import LittleGroupADT
from principia_materia.phonon_id.analytic_tensors import AnalyticTensors
from principia_materia.phonon_id.chainrule_derivatives import ChainruleDerivatives
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lattice_vectors = np.array([
    [0.0, 0.5, 0.5],
    [0.5, 0.0, 0.5],
    [0.5, 0.5, 0.0],
])
atoms = {
    &quot;Na&quot;: np.array([[0.0, 0.0, 0.0]]),
    &quot;Cl&quot;: np.array([[0.5, 0.5, 0.5]]),
}
supa = np.identity(3, dtype=int)
orbitals = &quot;p&quot;
structure = CrystalFTG(vec=lattice_vectors, atoms=atoms, supa=supa, orbitals=orbitals)
</pre></div>
</div>
</div>
<section id="Analytic-dynamic-tensor">
<h2>Analytic dynamic tensor<a class="headerlink" href="#Analytic-dynamic-tensor" title="Permalink to this headline"></a></h2>
<p>Analytic dynamic tensor allows us to perform symmetry analysis of the phonon interactions at a given Q-point, and determine the irreducible derivatives allowed by symmetry and the the coefficients of the tensor elements with respect to the irreducible derivatives. Additionally, the vectorized tensor form facilitates linear operations, making it useful in further analysis.</p>
</section>
<section id="Little-group-ADT">
<h2>Little group ADT<a class="headerlink" href="#Little-group-ADT" title="Permalink to this headline"></a></h2>
<p>Analytic dynamic tensor with little group symmetry analysis approach.</p>
<ol class="arabic simple">
<li><p>Second order: (<span class="math notranslate nohighlight">\(L_x\)</span>, <span class="math notranslate nohighlight">\(L_x\)</span>)</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>Qpoint = parse_array(&quot;1/2 0 0; 1/2 0 0&quot;, dtype=Fraction)
Qpoint
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)],
 [Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lgadt = LittleGroupADT(
    structure=structure,
    pg=&quot;Oh&quot;,
    Qpoint=Qpoint)
lgadt.set_qpoint_displacement_rep()
lgadt.set_irreducible_derivatives()
lgadt.set_vectorized_tensor()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lgadt.irreducible_derivative_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[((((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A1g&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A1g&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eg&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eg&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0))),
  (&#39;A1g&#39;, 0))]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lgadt.vectorized_tensor.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(6, 6, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>for i in range(lgadt.n_irreducible_derivatives):
    print(i)
    print(lgadt.vectorized_tensor[:, :, i].real)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0
[[ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.33333333 -0.33333333 -0.33333333]
 [ 0.          0.          0.         -0.33333333  0.33333333  0.33333333]
 [ 0.          0.          0.         -0.33333333  0.33333333  0.33333333]]
1
[[ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.66666667  0.33333333  0.33333333]
 [ 0.          0.          0.          0.33333333  0.66666667 -0.33333333]
 [ 0.          0.          0.          0.33333333 -0.33333333  0.66666667]]
2
[[ 0.33333333 -0.33333333 -0.33333333  0.          0.          0.        ]
 [-0.33333333  0.33333333  0.33333333  0.          0.          0.        ]
 [-0.33333333  0.33333333  0.33333333  0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]]
3
[[ 0.66666667  0.33333333  0.33333333  0.          0.          0.        ]
 [ 0.33333333  0.66666667 -0.33333333  0.          0.          0.        ]
 [ 0.33333333 -0.33333333  0.66666667  0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.          0.        ]]
</pre></div></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Third order: (<span class="math notranslate nohighlight">\(\Gamma\)</span>, <span class="math notranslate nohighlight">\(L_x\)</span>, <span class="math notranslate nohighlight">\(L_x\)</span>)</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>Qpoint = parse_array(&quot;0 0 0; 1/2 0 0; 1/2 0 0&quot;, dtype=Fraction)
Qpoint
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)],
 [Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)],
 [Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lgadt = LittleGroupADT(
    structure=structure,
    pg=&quot;Oh&quot;,
    Qpoint=Qpoint)
lgadt.set_qpoint_displacement_rep()
lgadt.set_irreducible_derivatives()
lgadt.set_vectorized_tensor()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lgadt.irreducible_derivative_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[((((Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A1g&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eg&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A1g&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;A2u&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eg&#39;, 0))),
  (&#39;A1g&#39;, 0)),
 ((((Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eg&#39;, 0)),
   ((Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)), (&#39;Eu&#39;, 0))),
  (&#39;A1g&#39;, 0))]
</pre></div></div>
</div>
</section>
<section id="Analytic-tensors-within-a-given-FTG-at-a-given-order">
<h2>Analytic tensors within a given FTG at a given order<a class="headerlink" href="#Analytic-tensors-within-a-given-FTG-at-a-given-order" title="Permalink to this headline"></a></h2>
<p>For symmetry analysis of the FTG, one would start by constructing analytic dynamic tensors of the irreducible Q-points withith the FTG, and compute for the rest of the brillouin zone by rotating from the corresponding irreducible Q-points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>supa = np.diag([2, 2, 2])
at = AnalyticTensors(
    structure=structure,
    supa=supa,
    order=2,
    pg=&quot;Oh&quot;,
)
at.set_ADT(
    little_group=True,
    verbose=True,
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing ADT for Qpoint: ((0, 0, 0), (0, 0, 0))
Computing ADT for Qpoint: ((1/2, 0, 0), (1/2, 0, 0))
Computing ADT for Qpoint: ((1/2, 1/2, 0), (1/2, 1/2, 0))
Summarize irreducible derivatives.
Compute vectorized tensors.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>for irreducible_derivative in at.irreducible_derivative_names:
    print(tuple_to_str(irreducible_derivative))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((((0, 0, 0), (T1u, 0)), ((0, 0, 0), (T1u, 0))), (A1g, 0))
((((1/2, 0, 0), (A1g, 0)), ((1/2, 0, 0), (A1g, 0))), (A1g, 0))
((((1/2, 0, 0), (Eg, 0)), ((1/2, 0, 0), (Eg, 0))), (A1g, 0))
((((1/2, 0, 0), (A2u, 0)), ((1/2, 0, 0), (A2u, 0))), (A1g, 0))
((((1/2, 0, 0), (Eu, 0)), ((1/2, 0, 0), (Eu, 0))), (A1g, 0))
((((1/2, 1/2, 0), (A2u, 0)), ((1/2, 1/2, 0), (A2u, 0))), (A1g, 0))
((((1/2, 1/2, 0), (A2u, 0)), ((1/2, 1/2, 0), (A2u, 1))), (A1g, 0))
((((1/2, 1/2, 0), (A2u, 1)), ((1/2, 1/2, 0), (A2u, 1))), (A1g, 0))
((((1/2, 1/2, 0), (Eu, 0)), ((1/2, 1/2, 0), (Eu, 0))), (A1g, 0))
((((1/2, 1/2, 0), (Eu, 0)), ((1/2, 1/2, 0), (Eu, 1))), (A1g, 0))
((((1/2, 1/2, 0), (Eu, 1)), ((1/2, 1/2, 0), (Eu, 1))), (A1g, 0))
</pre></div></div>
</div>
</section>
<section id="Chainrule-derivatives">
<h2>Chainrule derivatives<a class="headerlink" href="#Chainrule-derivatives" title="Permalink to this headline"></a></h2>
<p>With the analytic tensors of the FTG, we are able to perform further analysis on phonon interactions. One of them is using chainrule derivatives to compute the transformation matrices for abitrary displacements for BID approach.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>supa = np.ones((3, 3), dtype=int) - 2 * np.identity(3, dtype=int)
chainrule =  ChainruleDerivatives(
    structure=structure,
    supa=supa,
    order=2,
    pg=&#39;Oh&#39;)
chainrule.set_ADT(verbose=True)
chainrule.set_basis()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing ADT for Qpoint: ((0, 0, 0), (0, 0, 0))
Computing ADT for Qpoint: ((1/2, 1/2, 0), (1/2, 1/2, 0))
Summarize irreducible derivatives.
Compute vectorized tensors.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>displacements = np.zeros((1, chainrule.order - 1, chainrule.supercell.natoms, chainrule.supercell.dim))
displacements[0, 0, 0, 0] = 1
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>matrix = chainrule.compute_chainrule(displacements)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>matrix.reshape((-1, chainrule.n_irreducible_derivatives)).real
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.25,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [-0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [-0.25,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [-0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.5 , -0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ,  0.  ],
       [ 0.  , -0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.5 , -0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ],
       [ 0.  ,  0.  , -0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.5 ,  0.  ,  0.  ],
       [ 0.  , -0.  , -0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.5 ,  0.  ],
       [ 0.  ,  0.  , -0.  , -0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ],
       [ 0.  ,  0.5 ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  , -0.  , -0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.5 ,  0.  ,  0.  ,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.  , -0.  ]])
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../hamiltonian/hamiltonian.html" class="btn btn-neutral float-left" title="Hamiltonian" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="finite_displacements.html" class="btn btn-neutral float-right" title="Finite Displacements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Marianetti Group.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>