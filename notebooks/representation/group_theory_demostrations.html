<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Symmetry of a molecule &mdash; Principia Materia  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Hamiltonian" href="../hamiltonian/hamiltonian.html" />
    <link rel="prev" title="Translation Group" href="../translation_group/translation_group.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../contents.html" class="icon icon-home"> Principia Materia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../documentations/contents.html">Documentations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../documentations/compute_id.html">Compute Irreducible Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentations/compute_thermal.html">Compute Phonon Linewidth and Thermal Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translation_group/translation_group.html">Translation Group</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Symmetry of a molecule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Symmetry-of-CO_2-molecule">Symmetry of <span class="math notranslate nohighlight">\(CO_2\)</span> molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Representation-of-atoms-in-a-molecule">Representation of atoms in a molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Displacements-of-a-molecule">Displacements of a molecule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Symmetry-analysis-for-phonons">Symmetry analysis for phonons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Symmetry-of-Displacements-of-a-Crystal">Symmetry of Displacements of a Crystal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Direct-product-and-symmetric-direct-product-of-irreducible-representations">Direct product and symmetric direct product of irreducible representations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hamiltonian/hamiltonian.html">Hamiltonian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/phonon_interaction_analysis.html">Symmetry analysis of phonon interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/finite_displacements.html">Finite Displacements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/lid.html">Lone Irreducible Derivatives (LID) Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/bid.html">Bundled Irreducible Derivatives (BID) Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/bid.html#Hierarchical-Supercell-BID-Approach">Hierarchical Supercell BID Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonon_id/linewidth.html">Phonon linewidth and thermal conductivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/modules.html">API Documentations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Principia Materia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../documentations/contents.html">Documentations</a> &raquo;</li>
      <li>Symmetry of a molecule</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/representation/group_theory_demostrations.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>%load_ext autoreload
%autoreload 2
</pre></div>
</div>
</div>
<section id="Symmetry-of-a-molecule">
<h1>Symmetry of a molecule<a class="headerlink" href="#Symmetry-of-a-molecule" title="Permalink to this headline"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import numpy as np
np.set_printoptions(linewidth=150)
from principia_materia.translation_group import Cluster
from principia_materia.representation import ClusterRep, DispClusterRep
</pre></div>
</div>
</div>
<section id="Symmetry-of-CO_2-molecule">
<h2>Symmetry of <span class="math notranslate nohighlight">\(CO_2\)</span> molecule<a class="headerlink" href="#Symmetry-of-CO_2-molecule" title="Permalink to this headline"></a></h2>
<section id="Representation-of-atoms-in-a-molecule">
<h3>Representation of atoms in a molecule<a class="headerlink" href="#Representation-of-atoms-in-a-molecule" title="Permalink to this headline"></a></h3>
<p>In this example, we analyze the symmetry of a <span class="math notranslate nohighlight">\(CO_2\)</span> molecule. Since the 3 atoms of the molecule are positioned along a line, the molecule has rotational symmetry along this axis. We can simplify the problem by studying the displacements along the rotational axis (referred to as <span class="math notranslate nohighlight">\(x\)</span>) and perpendicular to it (<span class="math notranslate nohighlight">\(y\)</span>), instead of all 3 dimensions.</p>
<p>For this 1 dimensional molecule, there is an inversion centered at the carbon atom, thus we can use point group <span class="math notranslate nohighlight">\(C_i\)</span> for the symmetry analysis of this molecule.</p>
<p>The representation of the molecule atoms is straightforward since each species can only map into each other under point operations. That is the carbon atom has its own odd mode and the 2 oxygen atoms linearly combine into an odd and an even mode.</p>
<p><img alt="co2" src="notebooks/translation_group/illustrations/molecule/co2.pdf" /></p>
<p>First, we construct a <em>Cluster</em> object with the atoms, and only <span class="math notranslate nohighlight">\(p_x\)</span> and <span class="math notranslate nohighlight">\(p_y\)</span> orbitals:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>atoms = {
    &quot;C&quot;: np.array([
        [0.0, 0.0, 0.0]
    ]),
    &quot;O&quot;: np.array([
        [ 1.0, 0.0, 0.0],
        [-1.0, 0.0, 0.0]
    ])
}
cluster = Cluster(atoms=atoms, orbitals=&quot;p_x,p_y&quot;)
</pre></div>
</div>
</div>
<p>Using the <em>ClusterRep</em> class, we can find that the representation of the molecule atoms decomposes into: $ <span class="math">\Gamma `= 2 A :nbsphinx-math:</span>oplus <a href="#id1"><span class="problematic" id="id2">`</span></a>B $</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cluster_rep = ClusterRep(cluster=cluster, pg=&quot;Ci&quot;)
cluster_rep.irrep_counter
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;A&#39;, 2), (&#39;B&#39;, 1)])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cluster_rep.construct_irreducible_basis()
cluster_rep.irrvec_dict
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([((&#39;A&#39;, 0), array([[1., 0., 0.]])),
             ((&#39;A&#39;, 1), array([[0.        , 0.70710678, 0.70710678]])),
             ((&#39;B&#39;, 0), array([[ 0.        ,  0.70710678, -0.70710678]]))])
</pre></div></div>
</div>
<p>And the basis of irreducible representations can also be computed easily:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{v}_{C, odd} = \vec{v}_{A} = \left[ 1, 0, 0 \right] ^T \\
\vec{v}_{O, odd} = \vec{v}_{A^{'}} = \frac{1}{\sqrt{2}}\left[ 0, 1, 1 \right] ^T \\
\vec{v}_{O, even} = \vec{v}_{B} = \frac{1}{\sqrt{2}}\left[ 0, 1, -1 \right] ^T \\\end{split}\]</div>
</section>
<section id="Displacements-of-a-molecule">
<h3>Displacements of a molecule<a class="headerlink" href="#Displacements-of-a-molecule" title="Permalink to this headline"></a></h3>
<p>The symmetry analysis of the displacements of the molecule can be easily performed with <em>DispClusterRep</em> class to obtain the irreducible representations:</p>
<div class="math notranslate nohighlight">
\[\Gamma = 2 A \oplus 4 B\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>disp_cluster_rep = DispClusterRep(cluster=cluster, pg=&quot;Ci&quot;)
disp_cluster_rep.irrep_counter
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;A&#39;, 2), (&#39;B&#39;, 4)])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>disp_cluster_rep.construct_irreducible_basis()
disp_cluster_rep.irrvec_dict
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([((&#39;A&#39;, 0),
              array([[ 0.        ,  0.        ,  0.70710678,  0.        , -0.70710678,  0.        ]])),
             ((&#39;A&#39;, 1),
              array([[ 0.        ,  0.        ,  0.        ,  0.70710678,  0.        , -0.70710678]])),
             ((&#39;B&#39;, 0), array([[1., 0., 0., 0., 0., 0.]])),
             ((&#39;B&#39;, 1), array([[0., 1., 0., 0., 0., 0.]])),
             ((&#39;B&#39;, 2),
              array([[0.        , 0.        , 0.70710678, 0.        , 0.70710678, 0.        ]])),
             ((&#39;B&#39;, 3),
              array([[0.        , 0.        , 0.        , 0.70710678, 0.        , 0.70710678]]))])
</pre></div></div>
</div>
<p>We can find the basis vectors of the irreducible representations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{v}_{C, x, odd} = \vec{v}_{B} = \left[ 1, 0, 0, 0, 0, 0 \right] ^T \\
\vec{v}_{C, y, odd} = \vec{v}_{B'} = \left[ 0, 1, 0, 0, 0, 0 \right] ^T \\
%
\vec{v}_{O, x, odd} = \vec{v}_{B''} = \frac{1}{\sqrt{2}}\left[ 0, 0, 1, 0, 1, 0 \right] ^T \\
\vec{v}_{O, y, odd} = \vec{v}_{B'''} = \frac{1}{\sqrt{2}}\left[ 0, 0, 0, 1, 0, 1 \right] ^T \\
\vec{v}_{O, x, even} = \vec{v}_{A} = \frac{1}{\sqrt{2}}\left[ 0, 0, 1, 0, -1, 0 \right] ^T \\
\vec{v}_{O, y, even} = \vec{v}_{A'} = \frac{1}{\sqrt{2}}\left[ 0, 0, 0, 1, 0, -1 \right] ^T \\\end{split}\]</div>
</section>
</section>
</section>
<section id="Symmetry-analysis-for-phonons">
<h1>Symmetry analysis for phonons<a class="headerlink" href="#Symmetry-analysis-for-phonons" title="Permalink to this headline"></a></h1>
<p>Here we demonstrate the symmetry analysis for phonons at a given <span class="math notranslate nohighlight">\(\textbf{q}\)</span>-point in a crystal, which can break down into several steps: 1. Find the irreducible representaions of the nuclei displacements at said <span class="math notranslate nohighlight">\(\textbf{q}\)</span>-point; 2. Using the direct product or symmetric direct product to find the irreducible derivatives at second order; 3. Compute the coefficients for the irreducible derivatives in the dynamic matrix.</p>
<section id="Symmetry-of-Displacements-of-a-Crystal">
<h2>Symmetry of Displacements of a Crystal<a class="headerlink" href="#Symmetry-of-Displacements-of-a-Crystal" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia import Fraction
from principia_materia.io_interface import parse_array
from principia_materia.translation_group import CrystalFTG
from principia_materia.representation import CharmBlochRep
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>vec =  np.array([
    [0.0, 0.5, 0.5],
    [0.5, 0.0, 0.5],
    [0.5, 0.5, 0.0],
])
atoms = {
    &quot;Na&quot;: np.array([
        [0.0, 0.0, 0.0]
    ]),
    &quot;Cl&quot;: np.array([
        [0.5, 0.5, 0.5],
    ])
}
orbitals = &quot;p&quot;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure = CrystalFTG(vec=vec, atoms=atoms, orbitals=orbitals)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cbr = CharmBlochRep(
    structure=structure,
    pg=&quot;Oh&quot;,
    qpoint=np.array(parse_array(&quot;0 0 0&quot;, dtype=Fraction)),
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cbr.irrep_counter
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;T1u&#39;, 2)])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cbr.construct_irreducible_basis()
cbr.orthogonalize_shift_modes(remove=True)
print(cbr.irrep_counter)
for key, val in cbr.irrvec_dict.items():
    print(key)
    print(np.round(val, 6))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;T1u&#39;, 1)])
(&#39;T1u&#39;, 0)
[[ 0.707107+0.j  0.      +0.j  0.      +0.j -0.707107+0.j  0.      +0.j  0.      +0.j]
 [ 0.      +0.j  0.707107+0.j  0.      +0.j  0.      +0.j -0.707107+0.j  0.      +0.j]
 [ 0.      +0.j  0.      +0.j  0.707107+0.j  0.      +0.j  0.      +0.j -0.707107+0.j]]
</pre></div></div>
</div>
</section>
<section id="Direct-product-and-symmetric-direct-product-of-irreducible-representations">
<h2>Direct product and symmetric direct product of irreducible representations<a class="headerlink" href="#Direct-product-and-symmetric-direct-product-of-irreducible-representations" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.representation import DirectProduct, SymmetricDirectProduct
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dp = DirectProduct(pg=&quot;Oh&quot;, irrep_inputs=[&quot;T1u&quot;, &quot;T1u&quot;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dp.irrep_counter
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;A1g&#39;, 1), (&#39;Eg&#39;, 1), (&#39;T1g&#39;, 1), (&#39;T2g&#39;, 1)])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dp.construct_irreducible_basis()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dp.irrvec_dict[(&quot;A1g&quot;, 0)]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.57735027, 0.        , 0.        , 0.        , 0.57735027, 0.        , 0.        , 0.        , 0.57735027]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dp.basis
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 0)),
 ((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 1)),
 ((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 2)),
 ((&#39;T1u&#39;, 1), (&#39;T1u&#39;, 0)),
 ((&#39;T1u&#39;, 1), (&#39;T1u&#39;, 1)),
 ((&#39;T1u&#39;, 1), (&#39;T1u&#39;, 2)),
 ((&#39;T1u&#39;, 2), (&#39;T1u&#39;, 0)),
 ((&#39;T1u&#39;, 2), (&#39;T1u&#39;, 1)),
 ((&#39;T1u&#39;, 2), (&#39;T1u&#39;, 2))]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp = SymmetricDirectProduct(pg=&quot;Oh&quot;, irrep_inputs=[&quot;T1u&quot;, &quot;T1u&quot;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp.irrep_counter
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;A1g&#39;, 1), (&#39;Eg&#39;, 1), (&#39;T2g&#39;, 1)])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp.construct_irreducible_basis()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp.irrvec_dict[(&quot;A1g&quot;, 0)]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.57735027, 0.        , 0.        , 0.57735027, 0.        , 0.57735027]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp.basis
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 0)),
 ((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 1)),
 ((&#39;T1u&#39;, 0), (&#39;T1u&#39;, 2)),
 ((&#39;T1u&#39;, 1), (&#39;T1u&#39;, 1)),
 ((&#39;T1u&#39;, 1), (&#39;T1u&#39;, 2)),
 ((&#39;T1u&#39;, 2), (&#39;T1u&#39;, 2))]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>sdp.get_integer_irrvec((&quot;A1g&quot;, 0))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1., 0., 0., 1., 0., 1.]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../translation_group/translation_group.html" class="btn btn-neutral float-left" title="Translation Group" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../hamiltonian/hamiltonian.html" class="btn btn-neutral float-right" title="Hamiltonian" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Marianetti Group.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>