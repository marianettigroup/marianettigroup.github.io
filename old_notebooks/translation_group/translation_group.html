<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Translation Group &mdash; Principia Materia  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../contents.html" class="icon icon-home"> Principia Materia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentations/contents.html">Documentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/modules.html">API Documentations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Principia Materia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../contents.html" class="icon icon-home"></a> &raquo;</li>
      <li>Translation Group</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/old_notebooks/translation_group/translation_group.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Translation-Group">
<h1>Translation Group<a class="headerlink" href="#Translation-Group" title="Permalink to this headline"></a></h1>
<p>In this submodule, we build up all the pieces of translation group, from a cluster and a lattice to primitive crystal and its supercell. This allows us to extract critical information of the structures, manipulate them, and study the electron and vibrational properties of them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import numpy as np
np.set_printoptions(linewidth=180, suppress=True)
</pre></div>
</div>
</div>
<section id="Cluster">
<h2>Cluster<a class="headerlink" href="#Cluster" title="Permalink to this headline"></a></h2>
<p>We begin with a cluster which consists of a collection of atoms in arranged positions.</p>
<p>For example, we can create a square of H atoms by providing the atom positions and orbitals:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.translation_group import Cluster
from principia_materia.symmetry import PointGroup
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>square = Cluster(atoms={
    &quot;H&quot;: [
        [ 1,  1],
        [ 1, -1],
        [-1,  1],
        [-1, -1],
    ]
}, orbitals=&quot;s&quot;)
square
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;principia_materia.translation_group.cluster.Cluster at 0x7f9ebf36e250&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>square.orbitals
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(0, &#39;s&#39;), (1, &#39;s&#39;), (2, &#39;s&#39;), (3, &#39;s&#39;)]
</pre></div></div>
</div>
<p>The cluster is centered at the origin.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>square.center
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0.])
</pre></div></div>
</div>
<p>We can rotate the cluster using the point operators in the C4v point group. The atoms will be rotated into each other’s spots but the entire cluster remains invariant. This will be used to construct representations of a cluster.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>pg = PointGroup(&quot;C4v&quot;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>square.rotate_atoms(pg.G[&quot;c4z&quot;][:2, :][:, :2])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1., -1.],
       [-1., -1.],
       [ 1.,  1.],
       [-1.,  1.]])
</pre></div></div>
</div>
</section>
<section id="Lattice">
<h2>Lattice<a class="headerlink" href="#Lattice" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> class contains only the lattice vectors and optionaly the point group of the lattice. The class mainly serves as an abstract class to build into more complex structures. But it contain all the key properties of a lattice, including the volume of the unit lattice, lengths and angels of the latiice vectors, reciprocal lattice, etc. Conversion between lattice basis and cartesian basis can also be done using the methods <code class="docutils literal notranslate"><span class="pre">lattice_to_cartesian</span></code> and <code class="docutils literal notranslate"><span class="pre">cartesian_to_lattice</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.translation_group import Lattice
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lattice = Lattice(vec=np.array([
    [0.0, 0.5, 0.5],
    [0.5, 0.0, 0.5],
    [0.5, 0.5, 0.0],
]))
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lattice.lattice_to_cartesian([0.5, 0.5, 0])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.25, 0.25, 0.5 ])
</pre></div></div>
</div>
</section>
<section id="LatticeFTG">
<h2>LatticeFTG<a class="headerlink" href="#LatticeFTG" title="Permalink to this headline"></a></h2>
<p>Derived from <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>, <code class="docutils literal notranslate"><span class="pre">LatticeFTG</span></code> explores properties of a superlattice with a supercell matrix. It finds the lattice points that fit in the given supercell. If point group is provided, irreducible lattice points and the rotational mapping of the lattice points will be found.</p>
<section id="The-algorithm-to-find-lattice-points-fit-in-the-supercell">
<h3>The algorithm to find lattice points fit in the supercell<a class="headerlink" href="#The-algorithm-to-find-lattice-points-fit-in-the-supercell" title="Permalink to this headline"></a></h3>
<p>Algorithm used in finding the lattice points in the superlattice is described in Appendix D of paper: PHYSICAL REVIEW B 100, 014303 (2019). It is the mathamatically optimal algorithm to find these points, with <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> time complexity. Meanwhile, it is also possible to assign and compute the index of each found point in <span class="math notranslate nohighlight">\(\mathcal{O}(1)\)</span> time complexity. This makes non-diagonal supercells as efficient to work with as diagonal supercells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.translation_group import LatticeFTG
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>superlattice = LatticeFTG(vec=np.array([
    [0.0, 0.5, 0.5],
    [0.5, 0.0, 0.5],
    [0.5, 0.5, 0.0],
]),
  supa=np.array([
      [-1, 1, 1],
      [1, -1, 1],
      [1, 1, -1],
]),
  pg=&quot;Oh&quot;,
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>superlattice.lattice_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 0, 0],
       [0, 0, 1],
       [0, 1, 0],
       [1, 0, 0]])
</pre></div></div>
</div>
<p>Multiplicity is the size of the supercell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>superlattice.multiplicity
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4
</pre></div></div>
</div>
<p>The irreducible lattice points form a unique set lattice points under point group symmetry. The <code class="docutils literal notranslate"><span class="pre">irreducible_lattice_points_trans</span></code> attribute contains the point group operations that rotate the lattice points to the irreducible lattice points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>superlattice.irreducible_lattice_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 0, 0],
       [0, 0, 1]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>superlattice.irreducible_lattice_points_trans
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;E&#39;, &#39;E&#39;, &#39;Ic2e&#39;, &#39;Ic2c&#39;], dtype=&#39;&lt;U7&#39;)
</pre></div></div>
</div>
</section>
</section>
<section id="Kpoints">
<h2>Kpoints<a class="headerlink" href="#Kpoints" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Kpoint</span></code> class finds all the k-points that fit for a given supercell, and the irreducible k-points and the point group operations that transform k-points to their irreducible counterpart. It uses <code class="docutils literal notranslate"><span class="pre">LatticeFTG</span></code> to find the reciprocal lattice points and convert them into kpoints.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.translation_group import Kpoints
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>kpoints = Kpoints(vec=np.array([
    [0.0, 0.5, 0.5],
    [0.5, 0.0, 0.5],
    [0.5, 0.5, 0.0],
]),
  supa=np.array([
      [-1, 1, 1],
      [1, -1, 1],
      [1, 1, -1],
]),
  pg=&quot;Oh&quot;,
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>kpoints.kpoints
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)],
       [Fraction(1, 2), Fraction(1, 2), Fraction(0, 1)],
       [Fraction(1, 2), Fraction(0, 1), Fraction(1, 2)],
       [Fraction(0, 1), Fraction(1, 2), Fraction(1, 2)]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>kpoints.irreducible_kpoints
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[Fraction(0, 1), Fraction(0, 1), Fraction(0, 1)],
       [Fraction(1, 2), Fraction(1, 2), Fraction(0, 1)]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>kpoints.irreducible_kpoints_trans
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;E&#39;, &#39;E&#39;, &#39;Ic2e&#39;, &#39;Ic2c&#39;], dtype=&#39;&lt;U7&#39;)
</pre></div></div>
</div>
</section>
<section id="CrystalFTG">
<h2>CrystalFTG<a class="headerlink" href="#CrystalFTG" title="Permalink to this headline"></a></h2>
<p>Derived from <code class="docutils literal notranslate"><span class="pre">Crystal</span></code> class which is a combination of <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> and <code class="docutils literal notranslate"><span class="pre">Cluster</span></code>, this class contains critical information of a crystal structure, including lattice vectors, species of atoms and their positions and the supercell matrix. The instances of this class store the key information of the strutures we will be studying with this package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia.translation_group import CrystalFTG
</pre></div>
</div>
</div>
<p>Here we define a rocksalt structure with lattice constant of 1.0, with a <span class="math notranslate nohighlight">\(2\times2\times2\)</span> diagonal supercell.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure =  CrystalFTG(
    vec=1 * np.array([
        [0.0, 0.5, 0.5],
        [0.5, 0.0, 0.5],
        [0.5, 0.5, 0.0],
    ]),
    atoms={
        &quot;Na&quot;: [[0, 0, 0]],
        &quot;Cl&quot;: [[0.5, 0.5, 0.5]],
    },
    orbitals=&quot;p&quot;,
    supa=np.array([
        [2, 0, 0],
        [0, 2, 0],
        [0, 0, 2],
    ])
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure.to_dict()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;vec&#39;,
              array([[0. , 0.5, 0.5],
                     [0.5, 0. , 0.5],
                     [0.5, 0.5, 0. ]])),
             (&#39;atoms&#39;,
              OrderedDict([(&#39;Na&#39;, array([[0., 0., 0.]])),
                           (&#39;Cl&#39;, array([[0.5, 0.5, 0.5]]))])),
             (&#39;orbitals&#39;, &#39;p&#39;),
             (&#39;supa&#39;,
              array([[2, 0, 0],
                     [0, 2, 0],
                     [0, 0, 2]]))])
</pre></div></div>
</div>
<p>The supercell creates a finite translation group with a finite number of translation points, within which we can explore vibrational properties of the crystal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure.supa_lattice.lattice_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 0, 0],
       [1, 0, 0],
       [0, 1, 0],
       [1, 1, 0],
       [0, 0, 1],
       [1, 0, 1],
       [0, 1, 1],
       [1, 1, 1]])
</pre></div></div>
</div>
<ol class="arabic">
<li><p>Displacement basis of q-points</p>
<p>The orbitals are set to “p” which transform like atomic displacements. We then can compute the displacement basis at an arbitrary q-point. The data is in dictionary form, with keys denoting the index of atom and the orbital, and the values being the displacement vector of the basis.</p>
</li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure.get_basis_at_q(np.array([0.5, 0.0, 0.0]))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([((0, &#39;p_x&#39;),
              array([[ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j]])),
             ((0, &#39;p_y&#39;),
              array([[ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j]])),
             ((0, &#39;p_z&#39;),
              array([[ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j]])),
             ((1, &#39;p_x&#39;),
              array([[ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.35355339+0.j,  0.        +0.j,  0.        +0.j],
                     [-0.35355339-0.j,  0.        +0.j,  0.        +0.j]])),
             ((1, &#39;p_y&#39;),
              array([[ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.35355339+0.j,  0.        +0.j],
                     [ 0.        +0.j, -0.35355339-0.j,  0.        +0.j]])),
             ((1, &#39;p_z&#39;),
              array([[ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.        +0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j],
                     [ 0.        +0.j,  0.        +0.j,  0.35355339+0.j],
                     [ 0.        +0.j,  0.        +0.j, -0.35355339-0.j]]))])
</pre></div></div>
</div>
<ol class="arabic" start="2">
<li><p>Wigner Seitz cell</p>
<p>One of the important properties of finite translation group is Wigner Seitz cell, which puts every atom closest to the origin. This feature is crucial in the Fourier Interpolation of phonons and their interactions.</p>
<p>The method return 3 pieces of information: 1. The translation point mapping from the atom of the WS cell to the primitive cell. 2. The index of the atom of WS cell in the primitive cell. 3. The WS weight of the atom.</p>
</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>ws_cell_translation, ws_cell_atoms, ws_cell_weights = \
    structure.get_wigner_seitz_cell(center=np.array([0, 0, 0]))
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CrystalFTG</span></code> builds supercell based on the primitive cell and the supercell matrix:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>structure.primitive, structure.supa
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;principia_materia.translation_group.crystal.Crystal at 0x7f9ebf4a30d0&gt;,
 array([[2, 0, 0],
        [0, 2, 0],
        [0, 0, 2]]))
</pre></div></div>
</div>
</section>
<section id="Find-a-minimum-supercell-that-fits-the-given-k-point(s)">
<h2>Find a minimum supercell that fits the given k-point(s)<a class="headerlink" href="#Find-a-minimum-supercell-that-fits-the-given-k-point(s)" title="Permalink to this headline"></a></h2>
<p>Function <code class="docutils literal notranslate"><span class="pre">get_minimum_supercell</span></code> returns a minimum supercell that fits the provided k-point(s). The algorithm is decribed in Section III(B) of paper: PHYSICAL REVIEW B 100, 014303 (2019).</p>
<p>Note that the mininmum supercellcell is not unique. Here we find the Hermite Normal form of the minimum cell which is unique.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from principia_materia import Fraction
from principia_materia.io_interface import parse_array
from principia_materia.translation_group import get_minimum_supercell
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>qpts = parse_array(&quot;1/2 0 0; 0 1/2 0&quot;, Fraction)
supa = get_minimum_supercell(qpts)
qpts, supa
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([[Fraction(1, 2), Fraction(0, 1), Fraction(0, 1)],
  [Fraction(0, 1), Fraction(1, 2), Fraction(0, 1)]],
 array([[2, 0, 0],
        [0, 2, 0],
        [0, 0, 1]]))
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Marianetti Group.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>