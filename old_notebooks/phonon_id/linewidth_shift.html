<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phonon Linewidth and Frequency Shift &mdash; Principia Materia  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../contents.html" class="icon icon-home"> Principia Materia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentations/contents.html">Documentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/modules.html">API Documentations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Principia Materia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../contents.html" class="icon icon-home"></a> &raquo;</li>
      <li>Phonon Linewidth and Frequency Shift</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/old_notebooks/phonon_id/linewidth_shift.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Phonon-Linewidth-and-Frequency-Shift">
<h1>Phonon Linewidth and Frequency Shift<a class="headerlink" href="#Phonon-Linewidth-and-Frequency-Shift" title="Permalink to this headline"></a></h1>
<p>Phonon linewidth and frequency shift can be computed with perturbation theory using the phonon interactions calculated with the methods in this package. The formulas are well defined for both quantities.</p>
<p>The algorithms for both quantities are optimized and parallelized for efficiency.</p>
<p>For convenience and minimization of integration error, tetrahedron method is used for integration over the Brillouin zone.</p>
<section id="Phonon-interaction-strength">
<h2>Phonon interaction strength<a class="headerlink" href="#Phonon-interaction-strength" title="Permalink to this headline"></a></h2>
<p>Phonon interaction strength is the renormalized dynamic tensors used in computation of phonon linewidth and shift.</p>
<div class="math notranslate nohighlight">
\[\Phi_{q_1}^{j_1}{}_{\cdots}^{\cdots}{}_{q_\mathcal{N}}^{j_\mathcal{N}} = \frac{1}{\sqrt{N}}\frac{1}{\mathcal{N} !}
\sum_{\alpha_1 \cdots \alpha_\mathcal{N}} \sum_{a_1 \cdots a_\mathcal{N}} %
\left[
D_{q_1}^{a_1 \alpha_1}{}_{\cdots}^{\cdots}{}_{q_\mathcal{N}}^{a_\mathcal{N} \alpha_\mathcal{N}} \nonumber
\prod_{i=1,...,\mathcal{N}}
\left( W_{q_i, j_i}^{a_i, \alpha_i}
\sqrt{\frac{\hbar}{2 m_{a_i} \omega_{q_i j_i}}} \right)
\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(\sum_{i=1,\cdots,\mathcal{N}} q_i = \vec{G}\)</span> <span class="math notranslate nohighlight">\(D\)</span> is the dynamic tensor, N is the size of FTG, <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> is the order of the derivative, <span class="math notranslate nohighlight">\(W\)</span> is the eigen vectors, <span class="math notranslate nohighlight">\(m\)</span> is the mass of the atoms, and <span class="math notranslate nohighlight">\(\omega\)</span> is the phonon frequencies.</p>
</section>
</section>
<section id="Linewidth">
<h1>Linewidth<a class="headerlink" href="#Linewidth" title="Permalink to this headline"></a></h1>
<p>The formula to compute phonon linewidth (a.k.a imaginary part of phonon self energy) is as follows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Gamma_{q, j}(\omega) = \frac{18 \pi}{\hbar^2}\sum_{j^{\prime} j^{\prime\prime} q^{\prime}}
|\Phi_{\bar{q}}^{j} {}_{q^{\prime}}^{j^{\prime}} {}_{q - q^{\prime}}^{j^{\prime\prime}}|^2
\{
  \left(n_{q^{\prime}, j^{\prime}} + n_{q - q^{\prime}, j^{\prime\prime}} + 1\right)
  \delta \left(\omega - \omega_{q^{\prime}, j^{\prime}} - \omega_{q - q^{\prime}, j^{\prime\prime}}\right)
  \nonumber \\
   +
  \left(n_{q^{\prime}, j^{\prime}} - n_{q - q^{\prime}, j^{\prime\prime}}\right)
  \left[ \delta \left(\omega + \omega_{q^{\prime}, j^{\prime}} - \omega_{q - q^{\prime}, j^{\prime\prime}}\right)
          -
         \delta \left(\omega - \omega_{q^{\prime}, j^{\prime}} + \omega_{q - q^{\prime}, j^{\prime\prime}}\right)
  \right]
\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> is the phonon interaction strength.</p>
<p>The delta functions here can be integrated using tetrahedron method described in Blöchl’s paper (<a class="reference external" href="https://doi.org/10.1103/PhysRevB.49.16223">P. E. Blöchl, O. Jepsen, and O. K. Andersen, Phys. Rev. B 49, 16223 (1994)</a>).</p>
</section>
<section id="Frequency-shift">
<h1>Frequency shift<a class="headerlink" href="#Frequency-shift" title="Permalink to this headline"></a></h1>
<p>Phonon frequency shift is also the real part of phonon self energy, which is the real part of the following formula.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta_{\kappa} = \frac{12}{\hbar} \sum_{q^{\prime}} \Phi_{\kappa, -\kappa, \kappa^{\prime}, -\kappa^{\prime}}
(2 \bar{n}_{\kappa^{\prime}} - 1) \\
-\frac{18}{\hbar^2} \sum_{\kappa^{\prime} \kappa^{\prime\prime}} \left\{
\left| \Phi_{\kappa, \kappa^{\prime}, \kappa^{\prime\prime}}\right|^2
    \left[
        \frac{\bar{n}_{\kappa^{\prime}} + \bar{n}_{\kappa^{\prime\prime}} + 1}
            {\left(\omega_{\kappa} + \omega_{\kappa^{\prime}} + \omega_{\kappa^{\prime\prime}}\right)_p}
       +\frac{- \bar{n}_{\kappa^{\prime}} + \bar{n}_{\kappa^{\prime\prime}}}
            {\left(\omega_{\kappa} + \omega_{\kappa^{\prime}} - \omega_{\kappa^{\prime\prime}}\right)_p}
       +\frac{\bar{n}_{\kappa^{\prime}} - \bar{n}_{\kappa^{\prime\prime}}}
            {\left(\omega_{\kappa} - \omega_{\kappa^{\prime}} - \omega_{\kappa^{\prime\prime}}\right)_p}
       +\frac{\bar{n}_{\kappa^{\prime}} + \bar{n}_{\kappa^{\prime\prime}} + 1}
            {\left(\omega_{\kappa} - \omega_{\kappa^{\prime}} - \omega_{\kappa^{\prime\prime}}\right)_p}
    \right] \\
    + 2 \Phi_{\kappa, -\kappa, \kappa^{\prime\prime}}
        \Phi_{\kappa^{\prime}, -\kappa^{\prime}, \kappa^{\prime\prime}}
        \frac{2\bar{n}_{\kappa^{\prime}} + 1}{\left(\omega_{\kappa^{\prime\prime}}\right)_p}
\right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa=(q, j)\)</span>, <span class="math notranslate nohighlight">\(\Phi\)</span> is the phonon interaction strength, and due to conservation of momentum, in <span class="math notranslate nohighlight">\(\Phi_{\kappa, \kappa^{\prime}, \kappa^{\prime\prime}}\)</span>, <span class="math notranslate nohighlight">\(q^{\prime\prime} = - q - q^{\prime}\)</span> and in <span class="math notranslate nohighlight">\(\Phi_{\kappa, -\kappa, \kappa^{\prime\prime}}\)</span> and <span class="math notranslate nohighlight">\(\Phi_{\kappa^{\prime}, -\kappa^{\prime}, \kappa^{\prime\prime}}\)</span>, <span class="math notranslate nohighlight">\(q^{\prime\prime} = \Gamma\)</span>.</p>
<p>The first part of the equation is the loop (L) diagram, the second bubble (B) diagram and the third tadpole (T) diagram. (Ref: <a class="reference external" href="https://doi.org/10.1103/PhysRevB.68.220509">M. Lazzeri, M. Calandra, and F. Mauri, Phys. Rev. B 68, 220509(R) (2003)</a>)</p>
<p>These Brillouin integrations can be executed with tetrahedron method described Kaprzyk’s paper (<a class="reference external" href="https://doi.org/10.1016/j.cpc.2011.08.022">S.Kaprzyk, Comp. Phys. Comm. 183, 2, 347 (2012)</a>). Since this is formula for phonon self energy the imaginary part the integration should match the result of phonon linewidth taking signs into consideration, and the real part is the phonon frequency shift.</p>
<section id="Thermal-conductivity">
<h2>Thermal conductivity<a class="headerlink" href="#Thermal-conductivity" title="Permalink to this headline"></a></h2>
<section id="Relaxation-time-approximation">
<h3>Relaxation time approximation<a class="headerlink" href="#Relaxation-time-approximation" title="Permalink to this headline"></a></h3>
<p>First, phonon life time can be computed from the linewidth</p>
<div class="math notranslate nohighlight">
\[\tau_{\textbf{q},j}=\frac{1}{\Gamma_{q, j}(\omega_{q, j})}\]</div>
<p>Then, the mode dependent heat capacity can be computed from phonon frequencies</p>
<div class="math notranslate nohighlight">
\[C_{\textbf{q},j} =
k_{B}
\left(\frac{\hbar\omega_{\textbf{q},j}}{k_{B}T}\right)^2
\frac{\exp({\hbar\omega_{\textbf{q},j}}/{k_{B}T})}{[\exp({\hbar\omega_{\textbf{q},j}}/{k_{B}T}) - 1]^2}\]</div>
<p>The RTA thermal conductivity can be computed with phonon life time, mode heat capacity, and mode group velocity</p>
<div class="math notranslate nohighlight">
\[\kappa^{RTA} = \frac{1}{N\Omega}\sum_{\textbf{q},j}
C_{\textbf{q},j}
\textbf{v}_{\textbf{q},j} \otimes \textbf{v}_{\textbf{q},j}
\tau_{\textbf{q},j}\]</div>
<p>Ref: <a class="reference external" href="https://doi.org/10.1103/PhysRevB.91.094306">A. Togo, L. Chaput, and I. Tanaka, Phys. Rev. B 91, 094306 (2015)</a></p>
</section>
<section id="Linear-Boltzmann-Transport-Equatione-(LBTE)">
<h3>Linear Boltzmann Transport Equatione (LBTE)<a class="headerlink" href="#Linear-Boltzmann-Transport-Equatione-(LBTE)" title="Permalink to this headline"></a></h3>
<p>Here we implemented the direct solution to the LBTE instead of the interative one, described in the referenced papers.</p>
<p>Ref: <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.110.265506">Chaput, Phys. Rev. Lett. 110, 265506 (2013)</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevB.88.045430">Fugallo, et al. Phys. Rev. B 88, 045430 (2013)</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Marianetti Group.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>